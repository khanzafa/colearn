{% extends 'base.html' %} 
{% load static %}
{% block title %}College Learning{% endblock %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
{% block content %}
<div class="container-fluid">
  <div class="row text-center">
    <div class="col">
      <div class="card bg-primary text-white">
            <div class="card-title">
                <h1 class="mb-0">DASHBOARD</h1>
            </div>
        </div>
    </div>
  </div>
  <div class="row my-2">
    <!-- belajar -->
    <div class="col-lg-8">
      <!-- Ringkasan Belajar -->
      <div class="row text-center">
        <!-- Jumlah Materi -->
        <div class="col-md-3 my-2">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                <i class="bi bi-book-half "></i>
                <b>Materi</b>
              </h5>
              <p class="card-text">{{ material_count }}</p>
            </div>
          </div>
        </div>
        <!-- Jumlah Tugas -->
        <div class="col-md-3 my-2">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                <i class="bi bi-file-earmark-fill"></i>
                <b>Tugas</b>
              </h5>
              <p class="card-text">{{ task_count }}</p>
            </div>
          </div>
        </div>
        <!-- Jumlah Kuis -->
        <div class="col-md-3 my-2">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                <i class="bi bi-card-list"></i>
                <b>Kuis</b>
              </h5>
              <p class="card-text">{{ quiz_count }}</p>
            </div>
          </div>
        </div>
        <!-- Jumlah Presensi -->
        <div class="col-md-3 my-2">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                <i class="bi bi-person-check-fill"></i>
                <b>Presensi</b>
              </h5>
              <p class="card-text">{{ presence_history_count }} / {{ total_presence_history_count }}</p>
            </div>
          </div>
        </div>
      </div>
      <!-- statistik belajar -->
      <div class="row">
        <div class="col my-2">
          <div class="card">
            <h5 class="card-header bg-info text-white">Statistik Belajar</h5>
            <div class="card-body">
              <canvas id="myChart"></canvas>
            </div>
          </div>
        </div>
      </div>
      <!-- pengumuman -->
      <div class="row">
        <div class="col my-2">
          <div class="card">
            <h5 class="card-header bg-info text-white">Pengumuman</h5>
            <div
              id="myCarousel"
              class="carousel slide"
              data-bs-ride="carousel"
              data-bs-interval="5000"
            >
              <!-- Set interval sesuai kebutuhan Anda -->
              <div class="carousel-indicators">
                {% for announcement in announcements %}
                <button
                  type="button"
                  data-bs-target="#myCarousel"
                  data-bs-slide-to="{{ forloop.counter0 }}"
                  class="{% if forloop.first %}active{% endif %}"
                  aria-current="{% if forloop.first %}true{% endif %}"
                  aria-label="Slide {{ forloop.counter }}"
                ></button>
                {% endfor %}
              </div>
              <div class="carousel-inner">
                {% for announcement in announcements %}
                <div
                  class="carousel-item {% if forloop.first %}active{% endif %}"
                >
                  <div class="card-body">
                    <h5 class="card-title">{{ announcement.title }}</h5>
                    <p class="card-subtitle text-muted">
                      {{ announcement.author }}
                    </p>
                    <p class="card-text">{{ announcement.content }}</p>
                    <p class="card-text">
                      <small class="text-muted"
                        >{{ announcement.date|date:"F j, Y H:i" }}</small
                      >
                    </p>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- profil pengguna -->
    <div class="col-lg-4">
      <div class="row text-center">
        <div class="col-md-12 my-2">
          <div class="card">
            <div class="card-header d-flex justify-content-center align-items-center">
              <h5 class="mb-0">
                <b>Profil Mahasiswa</b>
              </h5>
            </div>
            <!-- Biodata -->
            <div class="card-body">
              <img
                src="{{ student.photo.url }}"
                alt="Foto profil"
                class="rounded img-fluid"
                height="100"
              />
              <table class="table table-sm mt-3" style="text-align: left">
                <tr>
                  <td>Nama</td>
                  <td>:</td>
                  <td>{{ student.user.first_name }} {{ student.user.last_name }}</td>
                </tr>
                <tr>
                  <td>NIM</td>
                  <td>:</td>
                  <td>{{ student.nim }}</td>
                </tr>
                <tr>
                  <td>Fakultas</td>
                  <td>:</td>
                  <td>{{ student.faculty }}</td>
                </tr>
                <tr>
                  <td>Program Studi</td>
                  <td>:</td>
                  <td>{{ student.major }}</td>
                </tr>
                <tr>
                  <td>Semester</td>
                  <td>:</td>
                  <td>{{ student.batch }}</td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById("myChart").getContext("2d");
  const myChart = new Chart(ctx, {
    type: "line",
    data: {
      labels: [
        "Jan",
        "Feb",
        "Mar",
        "Apr",
        "May",
        "Jun",
        "Jul",
        "Aug",
        "Sep",
        "Oct",
        "Nov",
        "Dec",
      ],
      datasets: [
        {
          label: "Jumlah Materi",
          data: [12, 19, 3, 5, 2, 3, 7, 8, 9, 10, 11, 12],
          backgroundColor: "rgba(255, 99, 132, 0.2)",
          borderColor: "rgba(255, 99, 132, 1)",
          borderWidth: 1,
        },
        {
          label: "Jumlah Tugas",
          data: [5, 7, 2, 8, 3, 4, 6, 7, 8, 9, 10, 11],
          backgroundColor: "rgba(54, 162, 235, 0.2)",
          borderColor: "rgba(54, 162, 235, 1)",
          borderWidth: 1,
        },
        {
          label: "Jumlah Kuis",
          data: [3, 5, 1, 2, 6, 7, 8, 9, 10, 11, 12, 13],
          backgroundColor: "rgba(255, 206, 86, 0.2)",
          borderColor: "rgba(255, 206, 86, 1)",
          borderWidth: 1,
        },
        {
          label: "Jumlah Presensi",
          data: [8, 10, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14],
          backgroundColor: "rgba(75, 192, 192, 0.2)",
          borderColor: "rgba(75, 192, 192, 1)",
          borderWidth: 1,
        },
      ],
    },
    options: {
      scales: {
        y: {
          beginAtZero: true,
        },
      },
    },
  });
</script>

{% endblock %}
